import{c as B,r,j as e,B as o,b as _,h as S,d as R,C as q,I as U,X as V,f as u}from"./index-BEYPvdD8.js";import{A as W,P as b}from"./AdminLayout-CYLxn9p4.js";import{C as X}from"./Card-DURhmg8t.js";import{M as G}from"./Modal-ClyrXK3F.js";import{S as H}from"./square-pen-NwD7cd36.js";import{C as J,I as k,S as K}from"./save-BxlFxD-6.js";const Q=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],A=B("type",Q),Y=[{value:"text",label:"Text (S, M, L, XL)",icon:A},{value:"color",label:"Color Swatch",icon:b},{value:"image",label:"Image Swatch",icon:k}],ie=()=>{const[j,I]=r.useState([]),[P,f]=r.useState(!0),[v,n]=r.useState(null),[m,M]=r.useState(null),[E,c]=r.useState(!1),[x,g]=r.useState(null),[N,y]=r.useState(!1),[a,i]=r.useState({name:"",type:"text",is_active:!0,show_price_diff:!1,options:[]}),p=async()=>{f(!0);try{const t=await u.get("/admin/attributes");I(t.data.data||[])}catch(t){n(t.response?.data?.message||"Failed to load attributes")}finally{f(!1)}};r.useEffect(()=>{p()},[]);const w=()=>{g(null),i({name:"",type:"text",is_active:!0,show_price_diff:!1,options:[]}),c(!0)},D=t=>{g(t),i({name:t.name,type:t.type,is_active:t.is_active,show_price_diff:t.show_price_diff??!1,options:t.options||[]}),c(!0)},L=async()=>{if(!a.name.trim()){n("Attribute name is required");return}y(!0);try{x?await u.put(`/admin/attributes/${x.id}`,a):await u.post("/admin/attributes",a),c(!1),p()}catch(t){n(t.response?.data?.message||"Failed to save attribute")}finally{y(!1)}},O=async t=>{if(confirm("Delete this attribute and all its options?"))try{await u.delete(`/admin/attributes/${t}`),p()}catch(s){n(s.response?.data?.message||"Failed to delete attribute")}},z=()=>{i(t=>({...t,options:[...t.options,{value:"",label:"",color_code:"",image:""}]}))},h=(t,s,l)=>{i(d=>({...d,options:d.options.map((C,$)=>$===t?{...C,[s]:l}:C)}))},T=t=>{i(s=>({...s,options:s.options.filter((l,d)=>d!==t)}))},F=t=>{switch(t){case"color":return e.jsx(b,{className:"w-4 h-4 text-purple-500"});case"image":return e.jsx(k,{className:"w-4 h-4 text-blue-500"});default:return e.jsx(A,{className:"w-4 h-4 text-neutral-500"})}};return e.jsxs(W,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary-900",children:"Product Attributes"}),e.jsx("p",{className:"text-neutral-500",children:"Manage global variant attributes (Color, Size, Pattern, etc.)"})]}),e.jsx(o,{onClick:w,leftIcon:e.jsx(_,{className:"w-4 h-4"}),children:"Add Attribute"})]}),v&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 flex justify-between",children:[v,e.jsx("button",{onClick:()=>n(null),children:"Ã—"})]}),e.jsx(X,{padding:"none",children:P?e.jsx("div",{className:"p-8 text-center text-neutral-500",children:"Loading attributes..."}):j.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(b,{className:"w-12 h-12 mx-auto mb-4 text-neutral-300"}),e.jsx("p",{className:"text-neutral-500 mb-4",children:"No attributes yet. Create your first attribute."}),e.jsx(o,{onClick:w,children:"Create Attribute"})]}):e.jsx("div",{className:"divide-y divide-neutral-100",children:j.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-neutral-50 cursor-pointer",onClick:()=>M(m===t.id?null:t.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[F(t.type),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:t.name}),e.jsxs("span",{className:"text-sm text-neutral-500 ml-2",children:["(",t.options_count," options)"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{variant:t.is_active?"success":"default",children:t.is_active?"Active":"Inactive"}),e.jsx(S,{variant:"info",children:t.type_display}),e.jsx("button",{onClick:s=>{s.stopPropagation(),D(t)},className:"p-2 hover:bg-neutral-100 rounded-lg",children:e.jsx(H,{className:"w-4 h-4 text-neutral-500"})}),e.jsx("button",{onClick:s=>{s.stopPropagation(),O(t.id)},className:"p-2 hover:bg-red-50 rounded-lg",children:e.jsx(R,{className:"w-4 h-4 text-red-500"})}),m===t.id?e.jsx(J,{className:"w-5 h-5"}):e.jsx(q,{className:"w-5 h-5"})]})]}),m===t.id&&t.options.length>0&&e.jsx("div",{className:"px-4 pb-4 bg-neutral-50",children:e.jsx("div",{className:"flex flex-wrap gap-3 pt-2",children:t.options.map((s,l)=>e.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-lg border border-neutral-200",children:[t.type==="color"&&s.color_code&&e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-neutral-200",style:{backgroundColor:s.color_code}}),t.type==="image"&&s.image&&e.jsx("img",{src:s.image,alt:s.value,className:"w-8 h-8 rounded object-cover"}),e.jsx("span",{children:s.label||s.value})]},l))})})]},t.id))})}),e.jsx(G,{isOpen:E,onClose:()=>c(!1),title:x?"Edit Attribute":"Create Attribute",size:"lg",children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx(U,{label:"Attribute Name *",value:a.name,onChange:t=>i(s=>({...s,name:t.target.value})),placeholder:"e.g., Color, Size, Pattern"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Swatch Type *"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:Y.map(t=>e.jsxs("button",{type:"button",onClick:()=>i(s=>({...s,type:t.value})),className:`flex flex-col items-center p-4 rounded-lg border-2 transition-colors ${a.type===t.value?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-primary-300"}`,children:[e.jsx(t.icon,{className:`w-6 h-6 mb-2 ${a.type===t.value?"text-primary-500":"text-neutral-400"}`}),e.jsx("span",{className:"text-sm text-center",children:t.label})]},t.value))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:"Options"}),e.jsxs(o,{size:"sm",variant:"outline",onClick:z,children:[e.jsx(_,{className:"w-4 h-4 mr-1"})," Add Option"]})]}),e.jsxs("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[a.options.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-neutral-50 rounded-lg",children:[e.jsx("input",{type:"text",value:t.value,onChange:l=>h(s,"value",l.target.value),placeholder:"Value (e.g., Red, Small)",className:"flex-1 px-3 py-2 rounded border border-neutral-300 text-sm"}),a.type==="color"&&e.jsx("input",{type:"color",value:t.color_code||"#000000",onChange:l=>h(s,"color_code",l.target.value),className:"w-10 h-10 rounded cursor-pointer",title:"Pick color"}),a.type==="image"&&e.jsx("input",{type:"text",value:t.image||"",onChange:l=>h(s,"image",l.target.value),placeholder:"Image URL",className:"flex-1 px-3 py-2 rounded border border-neutral-300 text-sm"}),e.jsx("button",{onClick:()=>T(s),className:"p-2 text-red-500 hover:bg-red-50 rounded",children:e.jsx(V,{className:"w-4 h-4"})})]},s)),a.options.length===0&&e.jsx("p",{className:"text-sm text-neutral-400 text-center py-4",children:'No options yet. Click "Add Option" to create values.'})]})]}),e.jsxs("div",{className:"p-4 bg-neutral-50 rounded-xl space-y-3",children:[e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-neutral-800",children:"Active"}),e.jsx("p",{className:"text-xs text-neutral-500",children:"Show this attribute on products"})]}),e.jsx("input",{type:"checkbox",checked:a.is_active,onChange:t=>i(s=>({...s,is_active:t.target.checked})),className:"w-5 h-5 rounded accent-primary-500"})]}),e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-neutral-800",children:"Show Price Difference"}),e.jsx("p",{className:"text-xs text-neutral-500",children:"Display +/- price on variant options"})]}),e.jsx("input",{type:"checkbox",checked:a.show_price_diff,onChange:t=>i(s=>({...s,show_price_diff:t.target.checked})),className:"w-5 h-5 rounded accent-primary-500"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(o,{variant:"outline",fullWidth:!0,onClick:()=>c(!1),children:"Cancel"}),e.jsx(o,{fullWidth:!0,onClick:L,disabled:N,children:N?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4 mr-2"})," Save Attribute"]})})]})]})})]})};export{ie as default};
